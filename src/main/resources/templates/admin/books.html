<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" th:replace="~{admin/fragments/layout :: layout(
        pageTitle=${'책 관리 - 세종족보'},
        currentPage=${'books'},
        content=~{::content},
        extraHead=~{::extraHead},
        extraScripts=~{::extraScripts}
      )}">

<th:block th:fragment="extraHead">
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link rel="stylesheet" th:href="@{/css/admin-search.css}">
    <style>
        .admin-books {
            padding: 1.25rem 2.5rem;
        }

        .admin-books .admin-actions {
            display: flex;
            gap: 0.625rem;
            margin-top: 0.625rem;
        }

        .admin-books .admin-btn {
            flex: 1;
            padding: 0.5rem 0.75rem;
            border: none;
            border-radius: 0.3125rem;
            font-size: 0.75rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            text-align: center;
        }

        .admin-books .manage-btn {
            background: #dc2626;
            color: white;
        }

        .admin-books .manage-btn:hover {
            background: #b91c1c;
            color: white;
            text-decoration: none;
        }

        .admin-books .category-section {
            margin-bottom: 2.5rem;
        }

        .admin-books .category-header {
            justify-content: center !important;
        }

        .admin-books .left-controls,
        .admin-books .right-controls {
            display: none;
        }

        .admin-books .page-title {
            text-align: center;
            margin-bottom: 1.875rem;
            padding: 1.25rem 0;
        }

        .admin-books .page-title h1 {
            color: #000000;
            font-size: 2rem;
            font-weight: 700;
            letter-spacing: -0.0625rem;
        }


        .jokbo-list-item {
            padding: 0.625rem;
            border-bottom: 0.0625rem solid #f3f4f6;
            display: flex;
            flex-direction: column;
            gap: 0.3125rem;
        }

        .jokbo-list-item:last-child {
            border-bottom: none;
        }

        .jokbo-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.875rem;
            font-weight: 600;
            color: #111827;
        }

        .jokbo-status {
            font-size: 0.75rem;
            padding: 0.125rem 0.375rem;
            border-radius: 624.9375rem;
        }

        .status-approved {
            background: #dcfce7;
            color: #166534;
        }

        .status-pending {
            font-size: 0.75rem;
            border-radius: 0.25rem;
            border: none;
            cursor: pointer;
            transition: background 0.2s;
            text-align: center;
            text-decoration: none;
            color: white;
        }

        .btn-view {
            background: #3b82f6;
        }

        .btn-view:hover {
            background: #2563eb;
        }

        .btn-reject {
            background: #f59e0b;
        }

        .btn-reject:hover {
            background: #d97706;
        }

        .btn-delete {
            background: #ef4444;
        }

        .btn-delete:hover {
            background: #dc2626;
        }

        .jokbo-empty {
            text-align: center;
            padding: 1.25rem;
            color: #6b7280;
            font-size: 0.875rem;
        }
    </style>
</th:block>

<th:block th:fragment="content">
    <div class="admin-books container">
        <div class="page-title">
            <h1>모든 책 관리</h1>
        </div>

        <div th:replace="admin/fragments/search-form :: search-section('searchForm', ~{::searchFields})">
            <th:block th:fragment="searchFields">
                <div class="search-group">
                    <label for="bookTitle">책 이름</label>
                    <input type="text" id="bookTitle" name="bookTitle" class="search-input" placeholder="책 이름을 입력하세요">
                </div>
                <div class="search-group">
                    <label for="author">저자</label>
                    <input type="text" id="author" name="author" class="search-input" placeholder="저자를 입력하세요">
                </div>
                <div class="search-group">
                    <label for="category">카테고리</label>
                    <select id="category" name="category" class="search-input">
                        <option value="">전체</option>
                        <option value="서양">서양</option>
                        <option value="동서양">동서양</option>
                        <option value="동양">동양</option>
                        <option value="과학">과학</option>
                    </select>
                </div>
                <button type="submit" class="search-btn">검색</button>
                <button type="button" class="reset-btn" data-search-reset>초기화</button>
            </th:block>
        </div>

        <div class="category-section">
            <div class="category-header">
                <div class="left-controls"></div>
                <div class="category-tabs subtle-shadow">
                    <button class="category-tab active" data-category="서양">서양</button>
                    <button class="category-tab" data-category="동서양">동서양</button>
                    <button class="category-tab" data-category="동양">동양</button>
                    <button class="category-tab" data-category="과학">과학</button>
                </div>
                <div class="right-controls"></div>
            </div>
        </div>

        <div class="book-display subtle-shadow" id="category-western" style="display: block;">
            <div class="books-grid" id="western-books">
                <div class="book-item" th:each="book : ${books}"
                    th:if="${book.category == 'west' or book.category == '서양'}" th:data-title="${book.title}"
                    th:data-author="${book.author}" th:data-category="서양">
                    <div class="book-cover">
                        <a th:href="'/admin/book/' + ${book.bookId}">
                            <img th:src="@{${book.imageUrl}}" th:alt="${book.title}">
                        </a>
                    </div>
                    <div class="book-info">
                        <h3 class="book-title" th:text="${book.title}">도서 제목</h3>
                        <p class="jokbo-count" th:text="'족보: ' + ${book.jokboCount} + '개'">족보: 0개</p>
                        <p class="book-author" th:text="${book.author}">저자</p>
                        <p class="book-publisher" th:text="${book.publisher}">출판사</p>
                        <div class="admin-actions">
                            <div class="jokbo-management-wrapper" th:data-book-id="${book.bookId}">
                                <button class="admin-btn manage-btn">족보 관리</button>
                                <div class="jokbo-dropdown">
                                    <div class="loading-spinner" style="text-align: center; padding: 0.625rem;">
                                        <i class="fas fa-spinner fa-spin"></i> 로딩중...
                                    </div>
                                    <div class="jokbo-list"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="book-display subtle-shadow" id="category-east-west" style="display: none;">
            <div class="books-grid" id="eastwest-books">
                <div class="book-item" th:each="book : ${books}"
                    th:if="${book.category == 'eastwest' or book.category == '동서양'}" th:data-title="${book.title}"
                    th:data-author="${book.author}" th:data-category="동서양">
                    <div class="book-cover">
                        <a th:href="'/admin/book/' + ${book.bookId}">
                            <img th:src="@{${book.imageUrl}}" th:alt="${book.title}">
                        </a>
                    </div>
                    <div class="book-info">
                        <h3 class="book-title" th:text="${book.title}">도서 제목</h3>
                        <p class="jokbo-count" th:text="'족보: ' + ${book.jokboCount} + '개'">족보: 0개</p>
                        <p class="book-author" th:text="${book.author}">저자</p>
                        <p class="book-publisher" th:text="${book.publisher}">출판사</p>
                        <div class="admin-actions">
                            <div class="jokbo-management-wrapper" th:data-book-id="${book.bookId}">
                                <button class="admin-btn manage-btn">족보 관리</button>
                                <div class="jokbo-dropdown">
                                    <div class="loading-spinner" style="text-align: center; padding: 0.625rem;">
                                        <i class="fas fa-spinner fa-spin"></i> 로딩중...
                                    </div>
                                    <div class="jokbo-list"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="book-display subtle-shadow" id="category-eastern" style="display: none;">
            <div class="books-grid" id="eastern-books">
                <div class="book-item" th:each="book : ${books}"
                    th:if="${book.category == 'east' or book.category == '동양'}" th:data-title="${book.title}"
                    th:data-author="${book.author}" th:data-category="동양">
                    <div class="book-cover">
                        <a th:href="'/admin/book/' + ${book.bookId}">
                            <img th:src="@{${book.imageUrl}}" th:alt="${book.title}">
                        </a>
                    </div>
                    <div class="book-info">
                        <h3 class="book-title" th:text="${book.title}">도서 제목</h3>
                        <p class="jokbo-count" th:text="'족보: ' + ${book.jokboCount} + '개'">족보: 0개</p>
                        <p class="book-author" th:text="${book.author}">저자</p>
                        <p class="book-publisher" th:text="${book.publisher}">출판사</p>
                        <div class="admin-actions">
                            <div class="jokbo-management-wrapper" th:data-book-id="${book.bookId}">
                                <button class="admin-btn manage-btn">족보 관리</button>
                                <div class="jokbo-dropdown">
                                    <div class="loading-spinner" style="text-align: center; padding: 0.625rem;">
                                        <i class="fas fa-spinner fa-spin"></i> 로딩중...
                                    </div>
                                    <div class="jokbo-list"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="book-display subtle-shadow" id="category-science" style="display: none;">
            <div class="books-grid" id="science-books">
                <div class="book-item" th:each="book : ${books}"
                    th:if="${book.category == 'science' or book.category == '과학'}" th:data-title="${book.title}"
                    th:data-author="${book.author}" th:data-category="과학">
                    <div class="book-cover">
                        <a th:href="'/admin/book/' + ${book.bookId}">
                            <img th:src="@{${book.imageUrl}}" th:alt="${book.title}">
                        </a>
                    </div>
                    <div class="book-info">
                        <h3 class="book-title" th:text="${book.title}">도서 제목</h3>
                        <p class="jokbo-count" th:text="'족보: ' + ${book.jokboCount} + '개'">족보: 0개</p>
                        <p class="book-author" th:text="${book.author}">저자</p>
                        <p class="book-publisher" th:text="${book.publisher}">출판사</p>
                        <div class="admin-actions">
                            <div class="jokbo-management-wrapper" th:data-book-id="${book.bookId}">
                                <button class="admin-btn manage-btn">족보 관리</button>
                                <div class="jokbo-dropdown">
                                    <div class="loading-spinner" style="text-align: center; padding: 0.625rem;">
                                        <i class="fas fa-spinner fa-spin"></i> 로딩중...
                                    </div>
                                    <div class="jokbo-list"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</th:block>

<th:block th:fragment="extraScripts">
    <script th:src="@{/js/admin-search.js}"></script>
    <script th:src="@{/js/admin-books.js}"></script>
</th:block>

</html>