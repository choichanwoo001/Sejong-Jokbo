<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/site-layout :: layout(
        pageTitle=${'고전독서 족보'},
        content=~{::content},
        extraHead=~{::extraHead},
        extraScripts=~{::extraScripts}
      )}">

<th:block th:fragment="extraHead">
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link rel="stylesheet" th:href="@{/css/notifications.css}">
</th:block>

<th:block th:fragment="content">
    <div class="container fade-in">
        <div class="site-title">
            <h1>고전독서 족보 사이트</h1>
        </div>

        <div class="search-section">
            <div class="search-container">
                <form id="searchForm" method="get" action="/search">
                    <input type="text" name="keyword" class="search-input subtle-shadow" placeholder="도서명, 저자, 출판사로 검색" th:value="${keyword}">
                </form>
            </div>
        </div>

        <div class="package-notice-banner">
            <div class="notice-content">
                <span class="notice-icon">📚</span>
                <span class="notice-text">패키지도서 정보는 <strong>페이지 하단</strong>을 참고해주세요</span>
                <a href="#package-section" class="notice-link">바로가기</a>
            </div>
        </div>

        <div th:if="${isSearch}" class="search-results">
            <div class="search-header">
                <h2 th:if="${keyword}" th:text="'검색 결과: ' + ${keyword}">검색 결과</h2>
                <a href="/" class="home-button">홈으로 가기</a>
            </div>
            <div class="books-grid">
                <div class="book-item"
                     th:each="book : ${books}"
                     th:data-book-url="@{'/book/' + ${book.bookId}}"
                     style="cursor: pointer;"
                     tabindex="0">
                    <div class="book-cover">
                        <img th:src="@{${book.imageUrl}}" th:alt="${book.title}">
                    </div>
                    <div class="book-info">
                        <h3 class="book-title" th:text="${book.title}">도서 제목</h3>
                        <p class="jokbo-count" th:text="'족보: ' + ${book.jokboCount} + '개'">족보: 0개</p>
                        <p class="book-author" th:text="${book.author}">저자</p>
                        <p class="book-publisher" th:text="${book.publisher}">출판사</p>
                    </div>
                </div>
            </div>
        </div>

        <div th:unless="${isSearch}">
            <div class="category-section">
                <div class="category-header">
                    <a href="/inquiry" class="inquiry-button">문의 게시판</a>
                    <div class="category-tabs subtle-shadow">
                        <button class="category-tab active">서양</button>
                        <button class="category-tab">동서양</button>
                        <button class="category-tab">동양</button>
                        <button class="category-tab">과학</button>
                    </div>
                    <select id="sortFilter" class="filter-dropdown">
                        <option value="name">이름순</option>
                        <option value="jokbo">족보 많은 순</option>
                    </select>
                </div>
            </div>

            <div class="book-display subtle-shadow" id="category-western" style="display: block;">
                <div class="books-grid">
                    <div class="book-item"
                         th:each="book : ${westernBooks}"
                         th:data-book-url="@{'/book/' + ${book.bookId}}"
                         th:data-book-id="${book.bookId}"
                         style="cursor: pointer;"
                         tabindex="0">
                        <div class="book-cover">
                            <img th:src="@{${book.imageUrl}}" th:alt="${book.title}">
                        </div>
                        <div class="book-info">
                            <h3 class="book-title" th:text="${book.title}">도서 제목</h3>
                            <p class="jokbo-count" th:text="'족보: ' + ${book.jokboCount} + '개'">족보: 0개</p>
                            <p class="book-author" th:text="${book.author}">저자</p>
                            <p class="book-publisher" th:text="${book.publisher}">출판사</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="book-display subtle-shadow" id="category-east-west" style="display: none;">
                <div class="books-grid">
                    <div class="book-item"
                         th:each="book : ${eastWestBooks}"
                         th:data-book-url="@{'/book/' + ${book.bookId}}"
                         th:data-book-id="${book.bookId}"
                         style="cursor: pointer;"
                         tabindex="0">
                        <div class="book-cover">
                            <img th:src="@{${book.imageUrl}}" th:alt="${book.title}">
                        </div>
                        <div class="book-info">
                            <h3 class="book-title" th:text="${book.title}">도서 제목</h3>
                            <p class="jokbo-count" th:text="'족보: ' + ${book.jokboCount} + '개'">족보: 0개</p>
                            <p class="book-author" th:text="${book.author}">저자</p>
                            <p class="book-publisher" th:text="${book.publisher}">출판사</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="book-display subtle-shadow" id="category-eastern" style="display: none;">
                <div class="books-grid">
                    <div class="book-item"
                         th:each="book : ${easternBooks}"
                         th:data-book-url="@{'/book/' + ${book.bookId}}"
                         th:data-book-id="${book.bookId}"
                         style="cursor: pointer;"
                         tabindex="0">
                        <div class="book-cover">
                            <img th:src="@{${book.imageUrl}}" th:alt="${book.title}">
                        </div>
                        <div class="book-info">
                            <h3 class="book-title" th:text="${book.title}">도서 제목</h3>
                            <p class="jokbo-count" th:text="'족보: ' + ${book.jokboCount} + '개'">족보: 0개</p>
                            <p class="book-author" th:text="${book.author}">저자</p>
                            <p class="book-publisher" th:text="${book.publisher}">출판사</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="book-display subtle-shadow" id="category-science" style="display: none;">
                <div class="books-grid">
                    <div class="book-item"
                         th:each="book : ${scienceBooks}"
                         th:data-book-url="@{'/book/' + ${book.bookId}}"
                         th:data-book-id="${book.bookId}"
                         style="cursor: pointer;"
                         tabindex="0">
                        <div class="book-cover">
                            <img th:src="@{${book.imageUrl}}" th:alt="${book.title}">
                        </div>
                        <div class="book-info">
                            <h3 class="book-title" th:text="${book.title}">도서 제목</h3>
                            <p class="jokbo-count" th:text="'족보: ' + ${book.jokboCount} + '개'">족보: 0개</p>
                            <p class="book-author" th:text="${book.author}">저자</p>
                            <p class="book-publisher" th:text="${book.publisher}">출판사</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="package-section" id="package-section">
            <div class="package-header">
                <h2>📚 패키지도서</h2>
                <p class="package-description">상대적으로 분량이 적은 두 권의 도서를 묶어 한 권처럼 시험을 진행하는 도서</p>
            </div>
            <div class="package-content">
                <div class="package-item">
                    <div class="package-info">
                        <h3>2023-1학기 기준 패키지도서</h3>
                        <div class="package-books">
                            <div class="package-book">
                                <span class="book-number">①</span>
                                <span class="book-category">동서양</span>
                                <span class="book-title">서유견문 / 파한집</span>
                            </div>
                        </div>
                        <p class="package-note">* 패키지도서는 두 권을 함께 학습하시면 됩니다.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</th:block>

<th:block th:fragment="extraScripts">
    <script th:src="@{/js/utils.js}"></script>
    <script th:src="@{/js/script.js}"></script>
    <script th:src="@{/js/sse.js}"></script>
    <script th:src="@{/js/user-sse-init.js}"></script>
</th:block>
</html>